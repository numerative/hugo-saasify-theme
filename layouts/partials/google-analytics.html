{{ if and hugo.IsProduction .Site.Params.googleAnalytics }}
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id={{ .Site.Params.googleAnalytics }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', '{{ .Site.Params.googleAnalytics }}');

  /**
   * Helper function to track purchase/conversion
   * @param {Object} data - Purchase data
   * @param {string} data.transaction_id - Unique transaction ID
   * @param {number} data.value - Purchase value in INR
   * @param {string} data.currency - Currency code (default: 'INR')
   * @param {string} data.item_name - Item/product name
   * @param {string} data.item_id - Item/product ID
   */
  window.trackPurchase = function(data) {
    if (typeof gtag === 'undefined') return;

    gtag('event', 'purchase', {
      transaction_id: data.transaction_id,
      value: data.value,
      currency: data.currency || 'INR',
      items: [{
        item_id: data.item_id || 'webinar_seat',
        item_name: data.item_name || 'Export Import Mastery Webinar',
        price: data.value,
        quantity: 1
      }]
    });
  };
</script>
{{ end }}
